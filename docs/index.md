# Welcome to ProteinGymPy

ProteinGym comprises a collection of benchmarks for evaluating the performance of models predicting the effect of point mutations generated by [Notin et al., 2023](https://pubmed.ncbi.nlm.nih.gov/38106144/). These datasets include Deep Mutational Scanning Assays (DMS) for 186 proteins, as well as performance scores for several models in both zero-shot and semi-supervised settings.

ProteinGymPy provides analysis-ready and reproducible access to these data resources from ProteinGym, as well as built-in functionality to visualize the data in Python. 

Below we provide installation instructions, a quick start demo, and two vignettes detailing 1) data importation and representation, and 2) visualization and exploration.

# Installation
To install the software, we recommend using [uv](https://docs.astral.sh/uv/#installation) for python management:

```
uv venv --python=3.13  #create a venv
source .venv/bin/activate 
uv pip install git+https://github.com/ccb-hms/ProteinGymPy.git#egg=ProteinGymPy
```

Addtional packages are required for jupyter notebook visualization functions:

```
uv pip install git+https://github.com/ccb-hms/ProteinGymPy.git#egg=ProteinGymPy[visualizations]
```

# Usage

## Quick Start

Load DMS substitution data (217 assays):
```python
from proteingympy import get_dms_substitution_data

# Load all DMS assays with UniProt IDs  
dms_data = get_dms_substitution_data()
print(f"Loaded {len(dms_data)} DMS assays")

# Access specific assay
assay_name = list(dms_data.keys())[0]
df = dms_data[assay_name]
print(df.head())
```

Load other datasets:
```python
from proteingympy import (
    get_alphamissense_proteingym_data,
    get_zero_shot_metrics,
    get_supervised_substitution_data
)

# AlphaMissense pathogenicity scores
am_data = get_alphamissense_proteingym_data()

# Zero-shot benchmarking metrics  
benchmarks = get_zero_shot_metrics()
print(f"Available metrics: {list(benchmarks.keys())}")

# Supervised model predictions
supervised_data, summary = get_supervised_substitution_data("random_5")
```

## Available Functions

| Function | Description |
|----------|-------------|
| [`get_dms_substitution_data()`](reference/get_dms_substitution_data.md) | Load 217 DMS substitution assays |
| [`get_dms_metadata()`](reference/get_dms_metadata.md) | Load DMS assay metadata/reference file |
| [`get_alphamissense_proteingym_data()`](reference/get_alphamissense_proteingym_data.md) | Load AlphaMissense pathogenicity scores |
| [`get_supervised_substitution_data()`](reference/get_supervised_substitution_data.md) | Load supervised model predictions for DMS subsitutions |
| [`get_zero_shot_substitution_data()`](reference/get_zero_shot_substitution_data.md) | Load zero-shot model predictions for DMS subsitutions |
| [`get_zero_shot_metrics()`](reference/get_zero_shot_metrics.md) | Load zero-shot benchmarking metrics |
| [`available_supervised_models()`](reference/available_supervised_models.md) | Get list of available supervised models |
| [`available_zero_shot_models()`](reference/available_zero_shot_models.md) | Get list of available zero-shot models |
| [`create_complete_metadata_table()`](reference/create_complete_metadata_table.md) | Generate comprehensive metadata |
| [`benchmark_models()`](reference/benchmark_models.md) | Benchmark multiple variant effect prediction models |
| [`dms_corr_plot()`](reference/dms_corr_plot.md) | Correlate model performance and DMS scores|
| [`model_corr_plot()`](reference/model_corr_plot.md) | Compare two model performance scores |
| [`plot_dms_heatmap()`](reference/plot_dms_heatmap.md) | Visualize DMS scores along a protein as a heatmap |
| [`plot_structure()`](reference/plot_structure.md) | Visualize DMS or model scores on 3D protein structure |





## Running Examples

### Quick Demo (No Downloads)
Run the simple demo to see available functions:
```bash
source .venv/bin/activate
python demo.py
```

### Comprehensive Examples
Run the full example script (includes data downloads):
```bash
source .venv/bin/activate
python examples/proteingym_pipeline_examples.py
```

This demonstrates all available data loading functions and shows the structure of each dataset.

## Running Tests

Run the test suite to verify functionality:
```bash
source .venv/bin/activate
python -m pytest tests/ -v
```

Or run specific test files:
```bash
source .venv/bin/activate  
python tests/test_data_pipelines.py
python tests/test_basic.py
```

The tests include:
- Unit tests for all data loading functions
- Integration tests for complete workflows  
- Mock tests that don't require network access
- Validation of data structure and consistency

## References
```
Notin, P., A. Kollasch, D. Ritter, L. van Niekerk, S. Paul, H. Spinner, N. Rollins, et al. 2023. “ProteinGym: Large-Scale Benchmarks for Protein Fitness Prediction and Design.” In Advances in Neural Information Processing Systems, edited by A. Oh, T. Neumann, A. Globerson, K. Saenko, M. Hardt, and S. Levine, 36:64331–79. Curran Associates, Inc.
```
